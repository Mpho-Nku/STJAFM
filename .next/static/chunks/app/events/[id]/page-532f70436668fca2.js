(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[857],{2771:function(e,t,n){Promise.resolve().then(n.bind(n,1060))},1060:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return l}});var s=n(7437),r=n(6463),i=n(2265),a=n(1180),c=n(7440);function l(){var e;let t=(0,r.useParams)(),n=null==t?void 0:t.id,[l,u]=(0,i.useState)(null),[o,d]=(0,i.useState)(null),[h,v]=(0,i.useState)(!0);(0,i.useEffect)(()=>{(async()=>{try{let{data:e}=await a.O.auth.getUser();d(null==e?void 0:e.user);let{data:t,error:s}=await a.O.from("events").select("*, church:church_id(*)").eq("id",n).single();s?console.error("Event fetch error:",s.message):u(t)}catch(e){console.error("Unexpected error:",e)}finally{v(!1)}})()},[n]);let f=async()=>{var e;if(!o)return alert("Please login to save events");let t=(null==l?void 0:null===(e=l.is_saved_by)||void 0===e?void 0:e.includes(o.id))?(l.is_saved_by||[]).filter(e=>e!==o.id):[...(null==l?void 0:l.is_saved_by)||[],o.id],{error:s}=await a.O.from("events").update({is_saved_by:t}).eq("id",n);s?(console.error("Save/Unsave failed:",s.message),alert("Something went wrong")):u({...l,is_saved_by:t})};if(h)return(0,s.jsx)("div",{children:"Loading..."});if(!l)return(0,s.jsx)("div",{className:"text-red-500",children:"Event not found"});let m=o&&(null===(e=l.is_saved_by)||void 0===e?void 0:e.includes(o.id));return(0,s.jsxs)("div",{className:"max-w-2xl mx-auto p-6 space-y-6",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold",children:l.title}),(0,s.jsx)("div",{className:"text-blue-600",children:(0,c.G)(l.start_time)}),(0,s.jsx)("p",{className:"text-gray-700",children:l.description}),l.church&&(0,s.jsxs)("div",{className:"card p-4 bg-white border border-gray-200 rounded-lg shadow-sm",children:[(0,s.jsxs)("h3",{className:"font-semibold",children:["Hosted by: ",l.church.name]}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:[l.church.street,l.church.suburb,l.church.township].filter(Boolean).join(", ")})]}),o&&(0,s.jsx)("button",{className:"btn ".concat(m?"bg-gray-300 text-black":"btn-primary"),onClick:f,children:m?"Unsave Event":"Save Event"})]})}},1180:function(e,t,n){"use strict";n.d(t,{O:function(){return s}});let s=(0,n(4392).createClientComponentClient)()},7440:function(e,t,n){"use strict";function s(e){return("string"==typeof e?new Date(e):e).toLocaleString()}n.d(t,{G:function(){return s}})},6463:function(e,t,n){"use strict";var s=n(1169);n.o(s,"useParams")&&n.d(t,{useParams:function(){return s.useParams}}),n.o(s,"useRouter")&&n.d(t,{useRouter:function(){return s.useRouter}})}},function(e){e.O(0,[392,971,23,744],function(){return e(e.s=2771)}),_N_E=e.O()}]);