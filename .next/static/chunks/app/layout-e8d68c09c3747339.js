(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{8886:function(e,t,s){Promise.resolve().then(s.t.bind(s,8877,23)),Promise.resolve().then(s.bind(s,7963))},7963:function(e,t,s){"use strict";s.d(t,{default:function(){return o}});var a=s(7437),l=s(7138),n=s(6648),r=s(1180),i=s(2265);let c=i.forwardRef(function(e,t){let{title:s,titleId:a,...l}=e;return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},l),s?i.createElement("title",{id:a},s):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0"}))});function o(){let[e,t]=(0,i.useState)(null),[s,o]=(0,i.useState)(!1),[d,u]=(0,i.useState)([]),[h,m]=(0,i.useState)(!1),[x,g]=(0,i.useState)([]);(0,i.useEffect)(()=>{r.O.auth.getUser().then(e=>{let{data:s}=e;return t(s.user)})},[]),(0,i.useEffect)(()=>{e&&r.O.from("events").select("id,title,start_time,church_id").order("start_time",{ascending:!0}).limit(5).then(e=>{let{data:t}=e,s=t||[];u(s);let a=JSON.parse(localStorage.getItem("seenNotifications")||"[]");m(s.some(e=>!a.includes(e.id)))})},[e]),(0,i.useEffect)(()=>{if(!e)return;let t=new Date,s=new Date(t);s.setDate(t.getDate()-t.getDay()+5),s.setHours(0,0,0,0);let a=new Date(s);a.setDate(s.getDate()+2),a.setHours(23,59,59,999),t<s&&(s.setDate(s.getDate()-7),a.setDate(a.getDate()-7)),r.O.from("events").select("id,title,start_time,church_id").gte("start_time",s.toISOString()).lte("start_time",a.toISOString()).order("start_time",{ascending:!0}).then(e=>{let{data:t}=e;return g(t||[])})},[e]);let f=()=>{let e=d.map(e=>e.id);localStorage.setItem("seenNotifications",JSON.stringify(e)),m(!1)},b=async()=>{await r.O.auth.signInWithOAuth({provider:"google",options:{redirectTo:"".concat(window.location.origin,"/auth/callback")}})},N=async()=>{await r.O.auth.signOut(),location.reload()};return(0,a.jsx)("div",{className:"w-full border-b border-blue-800 sticky top-0 z-30 backdrop-blur bg-white/80",children:(0,a.jsxs)("div",{className:"max-w-6xl mx-auto flex items-center justify-between px-4 py-3",children:[(0,a.jsx)("div",{className:"flex items-center gap-3",children:(0,a.jsx)(l.default,{href:"/",className:"text-xl font-bold text-blue-900",children:(0,a.jsx)(n.default,{src:"/logo.png",width:40,height:40,alt:"logo",className:"rounded-full"})})}),(0,a.jsx)("div",{className:"flex items-center gap-2 relative",children:e?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.default,{href:"/dashboard",className:"btn",children:"Dashboard"}),(0,a.jsx)("button",{className:"btn",onClick:N,children:"Sign out"}),(0,a.jsx)(l.default,{href:"/saved-events",className:"btn",children:"Saved Events"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("button",{className:"p-2 relative",onClick:()=>{o(!s),s||f()},children:[(0,a.jsx)(c,{className:"h-6 w-6 ".concat(h?"text-blue-600":"text-gray-400")}),h&&(0,a.jsx)("span",{className:"absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full"})]}),s&&(0,a.jsxs)("div",{className:"absolute right-0 mt-2 w-80 bg-white shadow-lg rounded-lg border border-gray-200 z-50",children:[(0,a.jsx)("div",{className:"p-3 font-semibold text-blue-900 border-b",children:"Notifications"}),(0,a.jsxs)("ul",{className:"max-h-48 overflow-y-auto",children:[d.map(e=>(0,a.jsx)("li",{className:"p-3 border-b hover:bg-gray-50",children:(0,a.jsxs)(l.default,{href:"/churches/".concat(e.church_id),onClick:()=>o(!1),children:[(0,a.jsx)("div",{className:"font-medium text-blue-800",children:e.title}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:new Date(e.start_time).toLocaleString()})]})},e.id)),0===d.length&&(0,a.jsx)("li",{className:"p-3 text-sm text-gray-500",children:"No new events."})]}),(0,a.jsx)("div",{className:"p-3 font-semibold text-blue-900 border-t",children:"This Weekend"}),(0,a.jsxs)("ul",{className:"max-h-40 overflow-y-auto",children:[x.map(e=>(0,a.jsx)("li",{className:"p-3 border-b hover:bg-gray-50",children:(0,a.jsxs)(l.default,{href:"/churches/".concat(e.church_id),onClick:()=>o(!1),children:[(0,a.jsx)("div",{className:"font-medium text-blue-800",children:e.title}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:new Date(e.start_time).toLocaleString()})]})},e.id)),0===x.length&&(0,a.jsx)("li",{className:"p-3 text-sm text-gray-500",children:"No weekend events."})]})]})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{className:"btn",onClick:b,children:"Login"}),(0,a.jsx)("button",{className:"btn btn-primary",onClick:b,children:"Sign up"})]})})]})})}},1180:function(e,t,s){"use strict";s.d(t,{O:function(){return a}});let a=(0,s(4392).createClientComponentClient)()},8877:function(){}},function(e){e.O(0,[404,392,138,648,971,23,744],function(){return e(e.s=8886)}),_N_E=e.O()}]);